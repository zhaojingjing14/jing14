<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>å¾®ä¿¡æ‰“é£æœº</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<style type="text/css">
			*{
				padding: 0;
				margin: 0;
			}
			html,body{
				width: 100%;
				height: 100%;
				overflow-x: hidden;
			}
			#wrap{
				position: relative;
				height: 100%;
			}
			/*canvas*/
			#map{
				display: block;
			}
			/*åˆ†æ•°*/
			#score{
				position: absolute;
				left: 0;
				top: 0;
			}
			/*å¼€å§‹åŠ è½½*/
			#loading{
				position: absolute;
				text-align: center;
				left: 50%;
				top: 50%;
				transform: translate(-50%,-50%);
			}
			/*èœå•*/
			#menu{
				position: absolute;
				width: 160px;
				height: 160px;
				border: 1px solid black;
				border-radius: 5px; 
				left: 0;
				top: 0;
				bottom: 0;
				right: 0;
				margin: auto;
				text-align: center;
				line-height: 40px;
				list-style: none;
				background: #bbc1c2;
				display: none;
			}
			#end_score{
              line-height: 80px;
              border-bottom:1px solid black;
              border-top: 1px solid black;
			}
			#restart{
				/*æ”¹å˜é¼ æ ‡çš„æ ·å¼,å°æ‰‹æŒ‡pointer*/
				cursor: pointer;
				/* é€šè¿‡csså–æ¶ˆç‚¹å‡»é€‰ä¸­,ie10ä¸æ”¯æŒ,æ ‡å‡†æµè§ˆå™¨åŠ ä¸Šå‰ç¼€	 */
				/*gg*/
				-webkit-user-select: none;
				/*huohu*/
				-moz-user-select: none;
				/*ie10ä»¥ä¸Š*/
				-ms-user-select: none;
				user-select: none;
			}
		</style>
	</head>
	<body>
		<div id="wrap">
			<canvas id="map"></canvas>
			<!--åˆ†æ•°-->
			<p id="score">åˆ†æ•°:0</p>
			<!--å¼€å§‹åŠ è½½åŒºåŸŸ-->
			<div id="loading">
				<img src="img/loading.gif"/>
				<p>æ¸¸æˆåŠ è½½ä¸­</p>
			</div>
			<!--æœ€åèœå•åŒºåŸŸ-->
			<ul id="menu">
				<li>é£æœºå¤§æˆ˜åˆ†æ•°</li>
				<li id="end_score">0</li>
				<li id="restart">é‡æ–°å¼€å§‹</li>
			</ul>
		</div>
	</body>
</html>
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript">
	var oCan = $("#map");
	var ctx = oCan.get(0).getContext("2d");
	//åˆ†æ•°
	var oScore = $("#score");
	//åŠ è½½
	var oLoad = $("#loading");
	//èœå•
	var oMenu = $("#menu");
	//åˆ†æ•°
	var oEndScore = $("#end_score");
	//é‡æ–°å¼€å§‹
	var oRestart = $("#restart");
	
	//ç»™ç”»å¸ƒæŒ‡å®šå®½é«˜
	oCan.get(0).width = $(document).width();
	oCan.get(0).height = $(document).height();
	//é¢„åŠ è½½,ä¿è¯å›¾ç‰‡åŠ è½½å®Œæˆ
	var imgNames = ["background.png","bullet1.png","bullet2.png","enemy1.png","enemy2.png","enemy3.png","herofly.png","loading.gif","prop.png"];
	//è¿›è¡Œå·²åŠ è½½
	//è®°å½•åŠ è½½å®Œæˆçš„å›¾ç‰‡ä¸ªæ•°
	var imgCount = 0;   
	for (var i = 0; i < imgNames.length; i++) {
		//load() æ–¹æ³•ä»æœåŠ¡å™¨åŠ è½½æ•°æ®ï¼Œå¹¶æŠŠè¿”å›çš„æ•°æ®æ”¾ç½®åˆ°æŒ‡å®šçš„å…ƒç´ ä¸­ã€‚
		$("<img />").prop("src","img/" + imgNames[i]).load(function(){
			imgCount++;
			if (imgCount == imgNames.length) {
				//å›¾ç‰‡åŠ è½½å®Œæ¯•
				console.log("æ‰€æœ‰å›¾ç‰‡åŠ è½½å®Œæ¯•");
				//éŸ³é¢‘æ–‡ä»¶é¢„åŠ è½½
				preloadMusic();
			}
		});
	};
	
	
	//ä¿å­˜æ‰€æœ‰çš„éŸ³é¢‘å¯¹è±¡
	var musics = [];
	function preloadMusic(){
		var count = 0;
		var audioNames = ["bullet.mp3","enemy1_down.mp3","enemy2_down.mp3","enemy3_down.mp3","game_music.mp3","game_over.mp3"];
		for (var i = 0; i < audioNames.length; i++) {
			var newAudio = $("<audio />").prop("src","audio/" + audioNames[i]).get(0);
			//æ”¾åˆ°æ•°ç»„ä¸­
			musics.push(newAudio);
			//éŸ³é¢‘å’Œè§†é¢‘çš„å…ƒæ•°æ®è¢«åŠ è½½æˆåŠŸçš„æ–¹æ³•
			newAudio.onloadedmetadata = function(){
				count++;
				if (count == audioNames.length) {
					console.log("æ‰€æœ‰éŸ³é¢‘æ–‡ä»¶åŠ è½½å®Œæˆäº†");
					//1.loadingæ¨¡å—æ¶ˆå¤±
					oLoad.css("display","none");
					//2.æ¸¸æˆéŸ³ä¹å“èµ·æ¥
					//å¾ªç¯æ’­æ”¾
					musics[4].loop = true;
					//èŒƒå›´0-1,1æœ€å¤§
					musics[4].volume = 1;
					musics[4].play();
					//å¼€å§‹æ¸¸æˆæµç¨‹
					main();
				}
			}
		};	
	};
	
	
	var img = new Image();
	img.src = "img/background.png";
	
	//========èƒŒæ™¯å¯¹è±¡(åªæœ‰ä¸€ä¸ª)
	var background = {
		    //èƒŒæ™¯ä¸€ç›´å¾€ä¸‹èµ°
	         y:0,	
	         //ç»˜åˆ¶,(åŸå›¾ä¸å¤±çœŸ)
	         draw:function(){
	         	//è¡Œ,è®°å½•ç«–ç›´æ–¹å‘ä¸ªæ•° é™¤ä»¥å›¾ç‰‡çš„é«˜åº¦,å‘ä¸Šå–æ•´
	         	var row = Math.ceil(oCan.height() / 568);
	         	//åˆ—
	         	var col = Math.ceil(oCan.width() / 320);
	         	//æ§åˆ¶ç«–ç›´å¹³é“º
	         	for (var i = -row; i < row; i++) {
	         		//æ§åˆ¶æ°´å¹³å¹³é“º
	         		for (var j = 0; j < col; j++) {
	         			//ç»˜åˆ¶èƒŒæ™¯å›¾ç‰‡
	         			ctx.drawImage(img,j*320,i*568 + this.y,320,568);
	         			
	         		}
	         	}
	        },
	         //ç§»åŠ¨
	         move:function(){
	         	this.y++;
	         	var row = Math.ceil(oCan.height() / 568);
	         	//è§£å†³å‡ºç°ç©ºç™½bug
	         	if (this.y  >= row * 568) {
	         		//åˆ¶ç©º,é‡æ–°å¼€å§‹
	         		this.y = 0;
	         	}
	         }
 	      };
	
	var imgFly = new Image();
	imgFly.src = "img/herofly.png";
	
	
	//è‹±é›„é£æœº
	var hero = {
		//è®°å½•è‹±é›„æ˜¯å¦çˆ†ç‚¸ğŸ’¥
		boom:false,
		w:66,
		h:82,
		//è‹±é›„åœ¨ç”»å¸ƒä¸­çš„ä½ç½®
		x:oCan.width() / 2 - 33,
		y:oCan.height() -182,
		//æ§åˆ¶å›¾ç‰‡çš„åˆ‡æ¢
		i:0,
		//æ§åˆ¶å›¾ç‰‡çš„åˆ‡æ¢é¢‘ç‡
		flagI:0,
		//è·Ÿå‘å°„å­å¼¹æœ‰å…³çš„å±æ€§
		amyType:0,  //0ä¸ºå•æ’å­å¼¹,1ä¸ºåŒæ’å­å¼¹
		//å‘å°„å‡ºæ¥çš„å­å¼¹é›†åˆ
		bullets:[],
		//æ§åˆ¶å‘å°„é¢‘ç‡
		flagS:0,
		//ç»˜åˆ¶âœˆï¸
		draw:function(){
			this.flagI++;
			if(this.flagI == 10){
				if (this.boom) {
				//çˆ†ç‚¸äº†
				//1.åŠ¨ç”»èµ°ä¸€é,ä»ä¸‹æ ‡ä¸º2å¼€å§‹
				this.i++;
				if (this.i ==5) {
					//çˆ†ç‚¸åŠ¨ç”»ç»“æŸ
					
				   //2.æ¸¸æˆç»“æŸ
				   gameOver(); 
				   
				}
				//éŸ³ä¹åœæ­¢
			  }else{
				//å…ˆåŠ å†é™¤
				this.i = (++this.i) % 2;
			 }
			  //åˆ¶ç©º
			  this.flagI = 0;
		  }
			//ç»˜åˆ¶é£æœº
			ctx.drawImage(imgFly,this.i*this.w,0,this.w,this.h,this.x,this.y,this.w,this.h);
		},
		//å­å¼¹å°„å‡»
		shoot:function(){
			if(!this.boom){
				//æ²¡çˆ†ç‚¸
				this.flagS++;
			}
			if (this.flagS == 5) {
				//æ’­æ”¾å‘å°„å­å¼¹çš„å£°éŸ³
				musics[0].play();
				if (this.amyType) {
					//ä¸ç­‰äº0,åŒæ’å­å¼¹
					var bullet = new Bullet(this.x + this.w/2-24,this.y + 22,48,14,$("<img />").prop("src","img/bullet2.png").get(0),2);
				}else{
					//ç­‰äº0å•æ’å­å¼¹
					var bullet = new Bullet(this.x + this.w/2-3,this.y - 18,6,14,$("<img />").prop("src","img/bullet1.png").get(0),1);
					
				}
				//æ–°åˆ›å»ºçš„å­å¼¹å¯¹è±¡,æ”¾åˆ°å­å¼¹é›†åˆä¸­
				this.bullets.push(bullet);
				//åˆ¶ç©º
				this.flagS = 0;
			}
			//ç§»åŠ¨å­å¼¹é›†åˆä¸­çš„æ¯ä¸€ä¸ªå­å¼¹
			for (var i = 0; i < this.bullets.length; i++) {
				//åˆ¤æ–­æœ‰æ²¡æœ‰è¶…å‡ºèŒƒå›´
				if (this.bullets[i].y <= -this.bullets[i].h) {
					//è¶…å‡º
					//åˆ é™¤è¶…å‡ºå±å¹•å­å¼¹
					this.bullets.splice(i,1);
					i--;
				}else{
					//æ²¡æœ‰è¶…å‡º,ç§»åŠ¨è¿™é¢—å­å¼¹
					this.bullets[i].move();
					this.bullets[i].draw();
				}
			}
		}
	};
	
	
	//å­å¼¹ç±»x,yæ§åˆ¶å­å¼¹ä½ç½®,w,hå®½é«˜,imgç»˜åˆ¶çš„å…·ä½“å›¾ç‰‡,ä¼¤å®³
	function Bullet(x,y,w,h,img,hurt){
		//å±æ€§
		this.x = x;
		this.y = y;
		this.w = w;
		this.h = h;
		this.img = img;
		this.hurt = hurt;
		
	}
	Bullet.prototype = {
		constructor:Bullet,
		//ç»˜åˆ¶å­å¼¹
		draw:function(){
			ctx.drawImage(this.img,this.x,this.y);
		},
		//ç§»åŠ¨
		move:function(){
			this.y -= 4;
		}
	};
	
	//æ§åˆ¶heroçš„ç§»åŠ¨
	oCan.mousedown(function(ev){
		var disx = ev.pageX;
		var disy = ev.pageY;
		//åˆ¤æ–­è§¦æ‘¸ç‚¹æ˜¯å¦åœ¨é£æœºheroæ‰€åœ¨çš„åŒºåŸŸ
		if (disx >= hero.x && disx <= hero.x+hero.w && disy >= hero.y && disy <= hero.y + hero.h) {
			//è¯´æ˜è§¦æ‘¸ç‚¹åœ¨heroåŒºåŸŸ
			oCan.mousemove(function(ev){
				//æ‰¾åˆ°ä¸­å¿ƒç‚¹
				hero.x = ev.pageX -hero.w / 2;
				hero.y = ev.pageY - hero.h / 2;
			});
			oCan.mouseup(function(){
				$(this).off("mousemove mouseup");
			});
		}
	});
	
	
	
	//ç§»åŠ¨ç«¯æ§åˆ¶heroç§»åŠ¨
	function start(ev){
		ev = ev || event;
		var touchObj = ev.touches[0];
		var disx = touchObj.pageX;
		var disy = touchObj.pageY;
		//åˆ¤æ–­
		if (disx >= hero.x && disx <= hero.x+hero.w && disy >= hero.y && disy <= hero.y + hero.h) {
			//è§¦æ‘¸ç‚¹åœ¨heroåŒºåŸŸ
			oCan.get(0).addEventListener("touchmove",move);
			//ç»™endç»‘å®šå‡½æ•°
			oCan.get(0).addEventListener("touchend",end);
			//å–æ¶ˆé»˜è®¤æ“ä½œ
			ev.preventDefault();
		}
		function move(ev){
			ev = ev || event;
			var touchObj = ev.touches[0];
			hero.x = touchObj.pageX -hero.w / 2;
			hero.y = touchObj.pageY - hero.h / 2;
			ev.preventDefault();
		}
		function end(){
		oCan.get(0).removeEventListener("touchmove",move);
		oCan.get(0).removeEventListener("touchend",end);
		}
	};
	oCan.get(0).addEventListener("touchstart",start);
	
	
	
	
	
	
	//æ•Œæœºç±»x,yæ§åˆ¶æ•Œæœºä½ç½®,w,hå®½é«˜,imgç»˜åˆ¶çš„å…·ä½“å›¾ç‰‡,è¡€,é€Ÿåº¦,åˆ†æ•°,æœ€å¤§å¼ æ•°
	function Enemy(x,y,w,h,img,hp,speed,score,maxI){
		this.x = x;
		this.y = y;
		this.w = w;
		this.h = h;
		this.img = img;
		this.hp = hp;
		this.speed = speed;
		this.score = score;
		//å›¾ç‰‡ä¸­æœ€å¤§çš„é›ªç¢§å…ƒç´ ä¸ªæ•°
		this.maxI = maxI;
		//é¢‘ç‡æ§åˆ¶
		this.flagI = 0;
		//æ§åˆ¶å›¾ç‰‡åˆ‡æ¢
		this.i =0;
		//è®°å½•æ˜¯å¦å¼€å§‹çˆ†ç‚¸
		this.boom = false;
		//è®°å½•æ˜¯å¦æ­»äº¡
		this.isDied = false;
		
	}
	//æ–¹æ³•
	Enemy.prototype = {
		constructor:Enemy,
		draw:function(){
			if (this.boom) {
				//åˆ‡æ¢å›¾ç‰‡(å¢å¤§é¢‘ç‡)
				this.flagI++;
				if (this.flagI == 5) {
					this.i++;
					if (this.i == this.maxI) {
						//è®°å½•æ˜¯å¦æ­»äº¡
						this.isDied = true;
					}
					this.flagI = 0;
				}
			}
			//ç»˜åˆ¶å›¾ç‰‡
			ctx.drawImage(this.img,this.i*this.w,0,this.w,this.h,this.x,this.y,this.w,this.h);
		},
		move:function(){
			this.y += this.speed;
		}
	};
	
	
	function ranNum (x,y){
		return Math.floor(Math.random()*(y-x+1) + x);
	}
	var EF1 = new Image();
	EF1.src = "img/enemy1.png";
	var EF2 = new Image();
	EF2.src = "img/enemy2.png";
	var EF3 = new Image();
	EF3.src = "img/enemy3.png";
	//ä¿å­˜æ‰€æœ‰çš„æ•Œæœº
	var enemys = [];
	function createEnemyAndMove(){
		var num = ranNum(1,1000);
		if (num <= 50) {
			//åˆ›å»ºæ•Œæœº
			if (num <= 40) {
				//å°é£æœº
				var enemy = new Enemy(ranNum(0,oCan.width() - 38),-34,38,34,EF1,1,ranNum(2,8),10,5);
			}else if (num  <= 48) {
				//ä¸­å‹æœº
				var enemy = new Enemy(ranNum(0,oCan.width() - 46),-64,46,64,EF2,5,ranNum(2,6),100,6);
			}else{
				//å¤§å‹æœº
				var enemy = new Enemy(ranNum(0,oCan.width() - 110),-164,110,164,EF3,10,ranNum(2,4),1000,10);
			}
			enemys.push(enemy);
		}
		//ç§»åŠ¨æ‰€æœ‰çš„æ•Œæœº
		for (var i = 0; i < enemys.length; i++) {
			//è¶…å‡ºå±å¹•,æˆ–è€…æ­»äº¡
			if (enemys[i].y >= oCan.height() + enemys[i].h || enemys[i].isDied) {
				//ä»æ•°ç»„ä¸­åˆ é™¤
				enemys.splice(i,1);
				i--;
			}else{
				enemys[i].move();
				enemys[i].draw();
			}
		}
	};
	
	//é“å…·ç±»      ç±»å‹,é€Ÿåº¦
	function Prop(x,y,w,h,type,speed){
		this.x = x;
		this.y = y;
		this.w = w;
		this.h = h;
		this.type = type;   // 0.1;0:ç‚¸å¼¹;1:æ¢æª
		this.speed = speed;
		//æ ‡è®°æ˜¯å¦è¢«ä½¿ç”¨
		this.isUsed = false;
	};
	
	var propImg = new Image();
	propImg.src = "img/prop.png";
	Prop.prototype = {
		constructor:Prop,
		//ç»˜åˆ¶
		draw:function(){
			ctx.drawImage(propImg,this.type*this.w,0,this.w,this.h,this.x,this.y,this.w,this.h);
		},
		//ç§»åŠ¨
		move:function(){
			this.y += this.speed;
		}
	};
	
	//ç”¨æ¥ç®¡ç†æ‰€æœ‰çš„é“å…·
	var props = [];
	function createPropAndMove(){
		var num = ranNum(1,1000);
		//æ§åˆ¶äº§ç”Ÿé“å…·çš„é¢‘ç‡
		if (num <= 20) {
			var prop = new Prop(ranNum(0,oCan.width() - 38),-68,38,68,ranNum(0,1),ranNum(5,10));
			props.push(prop);
		}
		//ç§»åŠ¨é“å…·(ç»“åˆæ¡ä»¶)
		for (var i = 0; i < props.length; i++) {
			if (props[i] >= oCan.height() + props[i].h || props[i].isUsed) {
				//æŠŠè¯¥é“å…·ä»æ•°ç»„ä¸­åˆ é™¤
				props.splice(i,1);
				//é˜²æ­¢æ¼å…ƒç´ 
				i--;
			}else{
				//ç»˜åˆ¶ç§»åŠ¨
				props[i].move();
		        props[i].draw();
			}
		}
	};
	
	
	//å°è£…ç¢°æ’æ£€æµ‹å·¥å…·å‡½æ•°
	function isCrach(obj1,obj2){
		var oT1 = obj1.y;
		var oB1 = obj1.y+obj1.h;
		var oL1 = obj1.x;
		var oR1 = obj1.x+obj1.w;
		
		var oT2 = obj2.y;
		var oB2 = obj2.y+obj2.h;
		var oL2 = obj2.x;
		var oR2 = obj2.x+obj2.w;
		
		//å…ˆåˆ¤æ–­ä¸ç¢°æ’
		if (oT2 > oB1 || oL2 > oR1 || oB2 < oT1  || oR2 < oL1) {
			//æ²¡æœ‰ç¢°æ’
			return false;
		} else{
			return true;
		}
	};



     //è®°å½•åˆ†æ•°
     var nScore = 0;
	//å»¶æ—¶å®šæ—¶å™¨
	var timerout = null;
	//å®Œæˆ3ç§ç±»å‹çš„ç¢°æ’æ£€æµ‹
	function check(){
		//1.æˆ‘æ–¹è‹±é›„å’Œé“å…·
		for (var i = 0; i < props.length; i++) {
			if (isCrach(hero,props[i])) {
				//ç¢°æ’äº†
				if (props[i].type) {
					//åŒæª
					hero.amyType = 1;
					//å»¶æ—¶
					clearTimeout(timerout);
					timerout = setTimeout(function(){
						hero.amyType = 0;
					},5000);
					
				}else{
					//ç‚¸å¼¹
					//æ‰€æœ‰çš„æ•Œæœº,å…¨éƒ¨çˆ†ç‚¸
					$.each(enemys, function(i,v) {
						v.boom = true;
						nScore += v.score;
						oScore.text("åˆ†æ•°:"+nScore);
					
					});
				}
				props[i].isUsed = true;
			}
		}
		//2.æ•Œæœºå’Œå­å¼¹
		//åŒå±‚forå¾ªç¯,å†…éƒ¨çš„break,æ˜¯ç»ˆæ­¢,å½“å‰å†…éƒ¨å¾ªç¯çš„,ä¸æ˜¯å¤–éƒ¨çš„æ•´ä¸ªå¾ªç¯
		for (var i = 0; i < enemys.length; i++) {
			//å­å¼¹
			for(var j = 0; j < hero.bullets.length; j++){
				//æ•Œæœºçˆ†ç‚¸,ä¸ç”¨åˆ¤æ–­è·Ÿå­å¼¹çš„å…³ç³»
				if (enemys[i].boom) {
					break;
				}
				//åˆ¤æ–­æœ‰æ²¡æœ‰ç¢°æ’
				if (isCrach(enemys[i],hero.bullets[j])) {
					//ç¢°æ’äº†
					//æ•Œæœºè¡€é‡å‡
					enemys[i].hp -= hero.bullets[j].hurt;
					if (enemys[i].hp <= 0) {
						enemys[i].boom = true;
						nScore += enemys[i].score;
						oScore.text("åˆ†æ•°:"+nScore);
						
							switch (enemys[i].maxI){
							case 5:
							//å°å‹æœº
							musics[1].play();
								break;
							case 6:
							//ä¸­å‹æœº
							musics[2].play();
								break;
							case 10:
							//å¤§å‹æœº
							musics[3].play();
								break;
							default:
								break;
						}
					}
					//å­å¼¹æ¶ˆå¤±
					hero.bullets.splice(j,1);
					j--;
				}
			}
		}
		//3.è‹±é›„ä¸æ•Œæœº
		for (var i = 0; i < enemys.length; i++) {
			if (enemys[i].boom) {
				continue;
			}
			if (isCrach(hero,enemys[i])) {
				
				hero.boom = true;
			}
		}
	};
	
	
	//æ¸¸æˆç»“æŸæ–¹æ³•
	function gameOver(){
		console.log("æ¸¸æˆç»“æŸ");
		//èƒŒæ™¯éŸ³ä¹å…³é—­
		musics[4].pause();
		//æ¸¸æˆç»“æŸçš„å£°éŸ³å“èµ·
		musics[5].play();
		//æœ€ç»ˆå¾—åˆ†
		oEndScore.text(nScore);
		//æ˜¾ç¤ºèœå•æ 
		oMenu.css("display","block");
		//ç»™é‡æ–°å¼€å§‹æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
		oRestart.click(function(){
			//åˆ·æ–°é¡µé¢
			location.reload();
		});
	};

	//ä¸»ä½“æµç¨‹
	function main(){
		ctx.clearRect(0,0,oCan.width(),oCan.height());
		//èƒŒæ™¯ç»˜åˆ¶
		background.draw();
		//èƒŒæ™¯ç§»åŠ¨
		background.move();
		//ç»˜åˆ¶è‹±é›„é£æœº
		hero.draw();
		//è‹±é›„å‘å­å¼¹
		hero.shoot();
		//ç»˜åˆ¶æ•Œæœº,å¹¶ä¸”ç§»åŠ¨æ‰€æœ‰åˆ›å»ºå¥½çš„æ•Œæœº
		createEnemyAndMove();
		//ç»˜åˆ¶é“å…·å¹¶ç§»åŠ¨
		createPropAndMove();
		//ç¢°æ’æ£€æµ‹
		if (!hero.boom) {
			//è‹±é›„é£æœºæ²¡æŒ‚
			check();
		}
	    //è°ƒç”¨mianå‡½æ•°
		requestAnimationFrame(main);
	};
	
	
	//æ›´è¯¥çª—å£å¤§å°.pcç«¯ä¸“ç”¨
	$(window).resize(function(){
		//è®¾ç½®ç”»å¸ƒçš„å¤§å°
		oCan.get(0).width = $(window).width();
		oCan.get(0).height = $(window).height();
		background.draw();
	});
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</script>